<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="HL_API_Help.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Appendix|IxLoad Examples">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" /><title>HTTP (HTTP_emulated_router.tcl)</title>
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../HL_API_Help.htm#HLTAPI/HLTAPI Examples/IxLoad Examples/HTTP_emulated_router.htm">Open topic with navigation</a>
        </p>
        <h3><a name="top"></a>HTTP (HTTP_emulated_router.tcl)</h3>
        <p class="CodeBlock">################################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3539919"></a>
                                                                               #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539920"></a>
          # Description: #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539921"></a>
          # This sample creates a HTTP client and server configuration with emulated #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539922"></a>
          # routers between emulated networks and port.Client is simulating a GET #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539923"></a>
          # command.</p>
        <p class="CodeBlock"><a name="0_pgfId-3539924"></a>
          # HTTP traffic is sent from clent side to server side. #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539925"></a>
          # At the end statistics are being retrieved. #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539926"></a>
                                                                               #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539927"></a>
          # Module: #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539928"></a>
          # The sample was tested on a LM1000STXS4-256 module. #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539929"></a>
                                                                               #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539930"></a>
          ################################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3539931"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539932"></a>
          package require Ixia</p>
        <p class="CodeBlock"><a name="0_pgfId-3539933"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539934"></a>
          set test_name [info script]</p>
        <p class="CodeBlock"><a name="0_pgfId-3539935"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539936"></a>
          set chassisIP sylvester</p>
        <p class="CodeBlock"><a name="0_pgfId-3539937"></a>
          set tclServer windowsStation</p>
        <p class="CodeBlock"><a name="0_pgfId-3539938"></a>
          set port_list [list 1/1 1/2]</p>
        <p class="CodeBlock"><a name="0_pgfId-3539939"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539940"></a>
          set error ""</p>
        <p class="CodeBlock"><a name="0_pgfId-3539941"></a>
          catch {</p>
        <p class="CodeBlock"><a name="0_pgfId-3539942"></a>
              #####</p>
        <p class="CodeBlock"><a name="0_pgfId-3539943"></a>
              # Connect to the chassis,reset to factory defaults and take ownership</p>
        <p class="CodeBlock"><a name="0_pgfId-3539944"></a>
              #####</p>
        <p class="CodeBlock"><a name="0_pgfId-3539945"></a>
              set connect_status [ixia::connect \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539946"></a>
                      -reset \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539947"></a>
                      -device $chassisIP \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539948"></a>
                      -port_list $port_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539949"></a>
                      -username ixiaApiUser \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539950"></a>
                      -tcl_server $tclServer ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3539951"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3539952"></a>
              if {[keylget connect_status status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3539953"></a>
                  return "FAIL - $test_name - [keylget connect_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3539954"></a>
              }</p>
        <p class="CodeBlock"><a name="0_pgfId-3539955"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3539956"></a>
          set port_handle1 [keylget \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539957"></a>
                  connect_status port_handle.$chassisIP.[lindex $port_list 0]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3539958"></a>
          set port_handle2 [keylget \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539959"></a>
                  connect_status port_handle.$chassisIP.[lindex $port_list 1]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3539960"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539961"></a>
          #########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3539962"></a>
          # Configure HTTP client #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539963"></a>
          #########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3539964"></a>
          set http_client_conf [ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539965"></a>
                  -target client	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539966"></a>
                  -property http \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539967"></a>
                  -mode add	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539968"></a>
                  -port_handle $port_handle1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539969"></a>
                  -mac_mapping_mode macport \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539970"></a>
                  -source_port_from 1024 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539971"></a>
                  -source_port_to 65535 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539972"></a>
                  -dns_cache_timeout 35000 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539973"></a>
                  -grat_arp_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539974"></a>
                  -congestion_notification_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539975"></a>
                  -time_stamp_enable 1 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539976"></a>
                  -keep_alive_time 9 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539977"></a>
                  -keep_alive_probes 75 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539978"></a>
                  -keep_alive_interval 9600 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539979"></a>
                  -fin_timeout 60 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539980"></a>
                  -receive_buffer_size 4096 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539981"></a>
                  -transmit_buffer_size 4096 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539982"></a>
                  -syn_ack_retries 5 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539983"></a>
                  -syn_retries 5 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539984"></a>
                  -retransmit_retries 15 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3539985"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539986"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539987"></a>
          if {[keylget http_client_conf status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3539988"></a>
              return "FAIL - $test_name - [keylget http_client_conf log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3539989"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3539990"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3539991"></a>
          ########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3539992"></a>
          # adding a network range for http client configuration #</p>
        <p class="CodeBlock"><a name="0_pgfId-3539993"></a>
          ########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3539994"></a>
          set client_network_conf [ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539995"></a>
                  -handle [keylget http_client_conf handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539996"></a>
                  -property network \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539997"></a>
                  -mode add	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539998"></a>
                  -ip_address_start 10.10.10.1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3539999"></a>
                  -mac_address_start 90.a0.a5.22.c1.09 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540000"></a>
                  -network_mask 255.255.255.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540001"></a>
                  -gateway 0.0.0.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540002"></a>
                  -ip_count 30 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540003"></a>
                  -ip_increment_step 0.0.0.1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540004"></a>
                  -mac_increment_step 00.00.00.00.00.01 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540005"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540006"></a>
          if {[keylget client_network_conf status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540007"></a>
              return "FAIL - $test_name - [keylget client_network_conf log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540008"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540009"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540010"></a>
          ##########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540011"></a>
          # adding two dns servers #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540012"></a>
          ##########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540013"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540014"></a>
          set client_dns_conf1 [::ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540015"></a>
                  -handle [keylget http_client_conf handles] 	\</p>
        <p class="CodeBlock"><a name="0_pgfId-3540016"></a>
                  -property dns \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540017"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540018"></a>
                  -dns_server 10.10.10.254 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540019"></a>
                  -dns_suffix .ixiacom.com ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540020"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540021"></a>
          if {[keylget client_dns_conf1 status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540022"></a>
              return "FAIL - $test_name - [keylget client_dns_conf1 log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540023"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540024"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540025"></a>
          set client_dns_conf2 [::ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540026"></a>
                  -handle [keylget http_client_conf handles] 	\</p>
        <p class="CodeBlock"><a name="0_pgfId-3540027"></a>
                  -property dns \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540028"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540029"></a>
                  -dns_server 10.10.10.253 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540030"></a>
                  -dns_suffix .ixiacom.com ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540031"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540032"></a>
          if {[keylget client_dns_conf2 status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540033"></a>
              return "FAIL - $test_name - [keylget client_dns_conf2 log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540034"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540035"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540036"></a>
          ##########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540037"></a>
          ##ading emulated router router_address/macperport client #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540038"></a>
          ##########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540039"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540040"></a>
          set emulated_gatewayc [ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540041"></a>
                  -handle [keylget http_client_conf handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540042"></a>
                  -property router_addr \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540043"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540044"></a>
                  -emulated_router_gateway 10.20.20.2 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540045"></a>
                  -emulated_router_subnet 255.255.255.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540046"></a>
                  -pool_ip_address_start 10.20.20.1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540047"></a>
                  -pool_ip_count 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540048"></a>
                  -pool_mac_address_start 00.0b.0a.12.c1.12 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540049"></a>
                  -pool_network 255.255.255.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540050"></a>
                  -pool_vlan_enable 0 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540051"></a>
          if {[keylget emulated_gatewayc status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540052"></a>
              return "FAIL - $test_name - [keylget emulated_gatewayc log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540053"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540054"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540055"></a>
          #####################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540056"></a>
          # configuring a http client traffic #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540057"></a>
          #####################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540058"></a>
          set http_client_traffic [::ixia::emulation_http_traffic_config 	\</p>
        <p class="CodeBlock"><a name="0_pgfId-3540059"></a>
                  -target client \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540060"></a>
                  -property traffic \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540061"></a>
                  -mode add ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540062"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540063"></a>
          if {[keylget http_client_traffic status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540064"></a>
              return "FAIL - $test_name - [keylget http_client_traffic log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540065"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540066"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540067"></a>
          ################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540068"></a>
          # Client AGENT #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540069"></a>
          ################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540070"></a>
          set http_client_agent [::ixia::emulation_http_traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540071"></a>
                  -property agent \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540072"></a>
                  -handle [keylget http_client_traffic handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540073"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540074"></a>
                  -max_sessions 3 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540075"></a>
                  -http_version 1.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540076"></a>
                  -keep_alive 0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540077"></a>
                  -max_persistent_requests 3 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540078"></a>
                  -follow_http_redirects 0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540079"></a>
                  -cookie_support_enable 0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540080"></a>
                  -http_proxy_enable 0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540081"></a>
                  -https_proxy_enable 0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540082"></a>
                  -ssl_enable 0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540083"></a>
                  -browser_emulation ie6 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540084"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540085"></a>
          if {[keylget http_client_agent status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540086"></a>
              return "FAIL - $test_name - [keylget http_client_agent log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540087"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540088"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540089"></a>
          #########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540090"></a>
          # Configure HTTP server #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540091"></a>
          #########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540092"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540093"></a>
          set http_server_conf [ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540094"></a>
                  -target server	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540095"></a>
                  -property http	 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540096"></a>
                  -mode add	 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540097"></a>
                  -port_handle $port_handle2 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540098"></a>
                  -mac_mapping_mode macport 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540099"></a>
                  -source_port_from 1024 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540100"></a>
                  -source_port_to 65535 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540101"></a>
                  -dns_cache_timeout 35000 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540102"></a>
                  -grat_arp_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540103"></a>
                  -congestion_notification_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540104"></a>
                  -time_stamp_enable 1 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540105"></a>
                  -keep_alive_time 9 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540106"></a>
                  -keep_alive_probes 75 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540107"></a>
                  -keep_alive_interval 9600 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540108"></a>
                  -fin_timeout 60 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540109"></a>
                  -receive_buffer_size 4096 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540110"></a>
                  -transmit_buffer_size 4096 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540111"></a>
                  -syn_ack_retries 5 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540112"></a>
                  -syn_retries 5 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540113"></a>
                  -retransmit_retries 15 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540114"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540115"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540116"></a>
          if {[keylget http_server_conf status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540117"></a>
              return "FAIL - $test_name - [keylget http_server_conf log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540118"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540119"></a>
          #######################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540120"></a>
          #adding a network range for this server configuration #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540121"></a>
          #######################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540122"></a>
          set http_server_network [ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540123"></a>
                  -handle [keylget http_server_conf handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540124"></a>
                  -property network \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540125"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540126"></a>
                  -ip_address_start 10.30.30.1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540127"></a>
                  -mac_address_start 00.04.04.04.98.00 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540128"></a>
                  -gateway 0.0.0.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540129"></a>
                  -ip_count 4 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540130"></a>
                  -network_mask 255.255.255.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540131"></a>
                  -ip_increment_step 0.0.0.1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540132"></a>
                  -mac_increment_step 00.00.00.00.00.01 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540133"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540134"></a>
          if {[keylget http_server_network status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540135"></a>
              return "FAIL - $test_name - [keylget http_server_network log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540136"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540137"></a>
          ##########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540138"></a>
          ##ading emulated router router_address/macperport server #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540139"></a>
          ##########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540140"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540141"></a>
          set emulated_gateways [ixia::emulation_http_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540142"></a>
                  -handle [keylget http_server_conf handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540143"></a>
                  -property router_addr \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540144"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540145"></a>
                  -emulated_router_gateway 10.20.20.1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540146"></a>
                  -emulated_router_subnet 255.255.255.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540147"></a>
                  -pool_ip_address_start 10.20.20.2 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540148"></a>
                  -pool_ip_count 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540149"></a>
                  -pool_mac_address_start 00.0a.0b.12.f1.12 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540150"></a>
                  -pool_network 255.255.255.0 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540151"></a>
                  -pool_vlan_enable 0 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540152"></a>
          if {[keylget emulated_gateways status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540153"></a>
              return "FAIL - $test_name - [keylget emulated_gateways log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540154"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540155"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540156"></a>
          #####################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540157"></a>
          # configuring a http server traffic #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540158"></a>
          #####################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540159"></a>
          set http_server_traffic [::ixia::emulation_http_traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540160"></a>
                  -target server \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540161"></a>
                  -property traffic \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540162"></a>
                  -mode add ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540163"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540164"></a>
          if {[keylget http_server_traffic status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540165"></a>
              return "FAIL - $test_name - [keylget http_server_traffic log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540166"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540167"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540168"></a>
          #####################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540169"></a>
          # adding an http server agent that will receive http client traffic #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540170"></a>
          #####################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540171"></a>
          set http_server_agent [::ixia::emulation_http_traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540172"></a>
                  -property agent \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540173"></a>
                  -handle [keylget http_server_traffic handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540174"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540175"></a>
                  -http_port 80 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540176"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540177"></a>
          if {[keylget http_server_agent status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540178"></a>
              return "FAIL - $test_name - [keylget http_server_agent log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540179"></a>
          } </p>
        <p class="CodeBlock"><a name="0_pgfId-3540180"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540181"></a>
          # We have SUCCESS</p>
        <p class="CodeBlock"><a name="0_pgfId-3540182"></a>
          # set some handy variables</p>
        <p class="CodeBlock"><a name="0_pgfId-3540183"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540184"></a>
          set serverPageHandles [keylget http_server_agent page_handles]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540185"></a>
          set serverHeaderHandles [keylget http_server_agent header_handles]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540186"></a>
          set serverCookieListHandles [keylget http_server_agent cookielist_handles]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540187"></a>
          set serverCookieHandles1 [keylget http_server_agent \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540188"></a>
                      [lindex $serverCookieListHandles 0].cookie_handles]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540189"></a>
          set serverCookieHandles2 [keylget http_server_agent \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540190"></a>
                      [lindex $serverCookieListHandles 1].cookie_handles]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540191"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540192"></a>
          ###############################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540193"></a>
          # CLIENT TRAFFIC AGENT ACTION #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540194"></a>
          ###############################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540195"></a>
          set http_client_action [::ixia::emulation_http_traffic_type_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540196"></a>
                  -property action \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540197"></a>
                  -handle [keylget http_client_agent handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540198"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540199"></a>
                  -command get \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540200"></a>
                  -destination [keylget http_server_agent handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540201"></a>
                  -page_handle [lindex $serverPageHandles 5] ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540202"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540203"></a>
          if {[keylget http_client_action status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540204"></a>
              return "FAIL - $test_name - [keylget http_client_action log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540205"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540206"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540207"></a>
          ##########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540208"></a>
          # map http client configuration with http client traffic #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540209"></a>
          ##########################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540210"></a>
          set http_client_map [::ixia::emulation_http_control_config 			 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540211"></a>
                  -target client \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540212"></a>
                  -property map \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540213"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540214"></a>
                  -client_iterations 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540215"></a>
                  -client_http_handle [keylget http_client_conf handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540216"></a>
                  -client_traffic_handle [keylget http_client_traffic handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540217"></a>
                  -objective_type users \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540218"></a>
                  -objective_value 30 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540219"></a>
                  -ramp_up_type users_per_second \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540220"></a>
                  -ramp_up_value 10 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540221"></a>
                  -client_sustain_time 43 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540222"></a>
                  -port_map_policy pairs \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540223"></a>
                  -ramp_down_time 20 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540224"></a>
                  -client_offline_time 2 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540225"></a>
                  -client_total_time 43 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540226"></a>
                  -client_standby_time 0 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540227"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540228"></a>
          if {[keylget http_client_map status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540229"></a>
              return "FAIL - $test_name - [keylget http_client_map log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540230"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540231"></a>
          ####################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540232"></a>
          #map http server configuration with server traffic #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540233"></a>
          ####################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540234"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540235"></a>
          set http_server_map [::ixia::emulation_http_control_config 			 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540236"></a>
                  -target server \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540237"></a>
                  -property map \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540238"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540239"></a>
                  -server_http_handle [keylget http_server_conf handles] 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540240"></a>
                  -server_traffic_handle [keylget http_server_traffic handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540241"></a>
                  -match_client_totaltime 1 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540242"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540243"></a>
          if {[keylget http_server_map status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540244"></a>
              return "FAIL - $test_name - [keylget http_server_map log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540245"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540246"></a>
          #########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540247"></a>
          #######STATISTICS########</p>
        <p class="CodeBlock"><a name="0_pgfId-3540248"></a>
          #########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540249"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540250"></a>
          ################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540251"></a>
          # create statistics for client.</p>
        <p class="CodeBlock"><a name="0_pgfId-3540252"></a>
          ###</p>
        <p class="CodeBlock"><a name="0_pgfId-3540253"></a>
          set client_stats_list {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540254"></a>
                  http_transactions</p>
        <p class="CodeBlock"><a name="0_pgfId-3540255"></a>
                  http_users_active</p>
        <p class="CodeBlock"><a name="0_pgfId-3540256"></a>
                  http_bytes_sent</p>
        <p class="CodeBlock"><a name="0_pgfId-3540257"></a>
                  http_bytes_received</p>
        <p class="CodeBlock"><a name="0_pgfId-3540258"></a>
                  http_cookies_received</p>
        <p class="CodeBlock"><a name="0_pgfId-3540259"></a>
                  http_cookies_sent</p>
        <p class="CodeBlock"><a name="0_pgfId-3540260"></a>
                  http_cookies_rejected</p>
        <p class="CodeBlock"><a name="0_pgfId-3540261"></a>
                  http_connect_time</p>
        <p class="CodeBlock"><a name="0_pgfId-3540262"></a>
                  http_cookies_rejected_path</p>
        <p class="CodeBlock"><a name="0_pgfId-3540263"></a>
                  http_cookies_rejected_domain</p>
        <p class="CodeBlock"><a name="0_pgfId-3540264"></a>
                  http_cookies_rejected_overflow</p>
        <p class="CodeBlock"><a name="0_pgfId-3540265"></a>
                  http_cookies_rejected_probabilistic</p>
        <p class="CodeBlock"><a name="0_pgfId-3540266"></a>
                  http_connect_time</p>
        <p class="CodeBlock"><a name="0_pgfId-3540267"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540268"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540269"></a>
          set http_client_stat [::ixia::emulation_http_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540270"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540271"></a>
                  -aggregation_type sum \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540272"></a>
                  -stat_name $client_stats_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540273"></a>
                  -stat_type client \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540274"></a>
                  -filter_type port \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540275"></a>
                  -filter_value $port_handle1 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540276"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540277"></a>
          if {[keylget http_client_stat status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540278"></a>
              return "FAIL - $test_name - [keylget http_client_stat log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540279"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540280"></a>
          set server_stats_list {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540281"></a>
                  http_requests_received</p>
        <p class="CodeBlock"><a name="0_pgfId-3540282"></a>
                  http_requests_successful</p>
        <p class="CodeBlock"><a name="0_pgfId-3540283"></a>
                  http_requests_failed</p>
        <p class="CodeBlock"><a name="0_pgfId-3540284"></a>
                  http_sessions_rejected</p>
        <p class="CodeBlock"><a name="0_pgfId-3540285"></a>
                  http_session_timeouts</p>
        <p class="CodeBlock"><a name="0_pgfId-3540286"></a>
                  http_transactions_active</p>
        <p class="CodeBlock"><a name="0_pgfId-3540287"></a>
                  http_bytes_received</p>
        <p class="CodeBlock"><a name="0_pgfId-3540288"></a>
                  http_bytes_sent</p>
        <p class="CodeBlock"><a name="0_pgfId-3540289"></a>
                  http_cookies_received</p>
        <p class="CodeBlock"><a name="0_pgfId-3540290"></a>
                  http_cookies_sent</p>
        <p class="CodeBlock"><a name="0_pgfId-3540291"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540292"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540293"></a>
          set http_server_stat [::ixia::emulation_http_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540294"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540295"></a>
                  -aggregation_type sum \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540296"></a>
                  -stat_name $server_stats_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540297"></a>
                  -stat_type server \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540298"></a>
                  -filter_type port \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540299"></a>
                  -filter_value $port_handle2 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540300"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540301"></a>
          if {[keylget http_server_stat status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540302"></a>
              return "FAIL - $test_name - [keylget http_server_stat log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540303"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540304"></a>
          #################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540305"></a>
          # Create a control configuration for client and server mappings #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540306"></a>
          #################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540307"></a>
          set http_control [::ixia::emulation_http_control 	 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540308"></a>
                  -mode add \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540309"></a>
                  -map_handle [list [keylget http_client_map handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540310"></a>
                  [keylget http_server_map handles]] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540311"></a>
                  -results_dir_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540312"></a>
                  -results_dir {http_results_dir} \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540313"></a>
                  -force_ownership_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540314"></a>
                  -release_config_afterrun_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540315"></a>
                  -reset_ports_enable 1 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540316"></a>
                  -stats_required 1 ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540317"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540318"></a>
          if {[keylget http_control status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540319"></a>
              return "FAIL - $test_name - [keylget http_control log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540320"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540321"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540322"></a>
          ###############</p>
        <p class="CodeBlock"><a name="0_pgfId-3540323"></a>
          # Start test</p>
        <p class="CodeBlock"><a name="0_pgfId-3540324"></a>
          ###</p>
        <p class="CodeBlock"><a name="0_pgfId-3540325"></a>
          set http_control [::ixia::emulation_http_control \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540326"></a>
                  -handle [keylget http_control handles] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540327"></a>
                  -mode start ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540328"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540329"></a>
          if {[keylget http_control status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540330"></a>
              return "FAIL - $test_name - [keylget http_control log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540331"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540332"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540333"></a>
          ###################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540334"></a>
          # Get statistics</p>
        <p class="CodeBlock"><a name="0_pgfId-3540335"></a>
          ###</p>
        <p class="CodeBlock"><a name="0_pgfId-3540336"></a>
          set client_stats_result [::ixia::emulation_http_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540337"></a>
                  -mode get \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540338"></a>
                  -handle [keylget http_client_stat handles] ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540339"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540340"></a>
          if {[keylget client_stats_result status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540341"></a>
              return "FAIL - $test_name - [keylget client_stats_result log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540342"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540343"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540344"></a>
          set server_stats_result [::ixia::emulation_http_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540345"></a>
                  -mode get \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540346"></a>
                  -handle [keylget http_server_stat handles] ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540347"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540348"></a>
          if {[keylget server_stats_result status] != $::SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540349"></a>
              return "FAIL - $test_name - [keylget server_stats_result log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540350"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540351"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540352"></a>
          ###########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540353"></a>
          # Print client statistics #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540354"></a>
          ###########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540355"></a>
          ixPuts "CLIENT STATISTICS:"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540356"></a>
          foreach {stat_handle} [keylkeys client_stats_result] {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540357"></a>
              if {$stat_handle != "status"} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540358"></a>
                  set stat_handle_kl [keylget client_stats_result $stat_handle]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540359"></a>
                  foreach {stat_type} [keylkeys stat_handle_kl] {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540360"></a>
                      set stat_type_kl [keylget stat_handle_kl $stat_type]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540361"></a>
                      foreach {stat_name} [keylkeys stat_type_kl] {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540362"></a>
                          set stat_name_kl [keylget stat_type_kl $stat_name]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540363"></a>
                          ixPuts -nonewline [format \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540364"></a>
                                  "%10s %10s %40s" $stat_handle $stat_type $stat_name]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540365"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540366"></a>
                          set timestamp [lindex [lsort -dictionary \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540367"></a>
                                  [keylkeys stat_name_kl]] end]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540368"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540369"></a>
                          ixPuts [format "%15s %15s" $timestamp \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540370"></a>
                                  [keylget stat_name_kl $timestamp]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540371"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540372"></a>
                      }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540373"></a>
                  }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540374"></a>
              }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540375"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540376"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540377"></a>
          ###########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540378"></a>
          # Print server statistics #</p>
        <p class="CodeBlock"><a name="0_pgfId-3540379"></a>
          ###########################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540380"></a>
          ixPuts "SERVER STATISTICS:"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540381"></a>
          foreach {stat_handle} [keylkeys server_stats_result] {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540382"></a>
              if {$stat_handle != "status"} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540383"></a>
                  set stat_handle_kl [keylget server_stats_result $stat_handle]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540384"></a>
                  foreach {stat_type} [keylkeys stat_handle_kl] {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540385"></a>
                      set stat_type_kl [keylget stat_handle_kl $stat_type]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540386"></a>
                      foreach {stat_name} [keylkeys stat_type_kl] {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540387"></a>
                          set stat_name_kl [keylget stat_type_kl $stat_name]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540388"></a>
                          ixPuts -nonewline [format \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540389"></a>
                                  "%10s %10s %40s" $stat_handle $stat_type $stat_name]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540390"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540391"></a>
                          set timestamp [lindex [lsort -dictionary \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540392"></a>
                                  [keylkeys stat_name_kl]] end]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540393"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540394"></a>
                          ixPuts [format "%15s %15s" $timestamp \</p>
        <p class="CodeBlock"><a name="0_pgfId-3540395"></a>
                                  [keylget stat_name_kl $timestamp]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3540396"></a>
        </p>
        <p class="CodeBlock"><a name="0_pgfId-3540397"></a>
                      }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540398"></a>
                  }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540399"></a>
              }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540400"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3540401"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540402"></a>
          } error</p>
        <p class="CodeBlock"><a name="0_pgfId-3540403"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3540404"></a>
          ##################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3540405"></a>
          # Disconnect and cleanup variables and sessions</p>
        <p class="CodeBlock"><a name="0_pgfId-3540406"></a>
          ###</p>
        <p class="CodeBlock"><a name="0_pgfId-3540407"></a>
          ::ixia::cleanup_session</p>
        <p class="CodeBlock"><a name="0_pgfId-3540408"></a>
          if {$error != ""} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540409"></a>
              ixPuts $error</p>
        <p class="CodeBlock"><a name="0_pgfId-3540410"></a>
          } else {</p>
        <p class="CodeBlock"><a name="0_pgfId-3540411"></a>
              return "SUCCESS - $test_name - [clock format [clock seconds]]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3540412"></a>
          }</p>
    </body>
</html>