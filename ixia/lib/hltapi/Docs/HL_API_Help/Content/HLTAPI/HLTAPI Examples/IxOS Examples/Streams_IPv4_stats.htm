<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="HL_API_Help.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Appendix|IxOS Examples">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" /><title>Traffic (Streams_IPv4_stats.tcl)</title>
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../HL_API_Help.htm#HLTAPI/HLTAPI Examples/IxOS Examples/Streams_IPv4_stats.htm">Open topic with navigation</a>
        </p>
        <h3><a name="top"></a>Traffic (Streams_IPv4_stats.tcl)</h3>
        <p class="CodeBlock">################################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3547981"></a>
                                                                               #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547982"></a>
          # Description: #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547983"></a>
          # This sample creates three IPv4 streams on a port, starts the streams #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547984"></a>
          # and displays statistics about them. #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547985"></a>
                                                                               #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547986"></a>
          # Module: #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547987"></a>
          # The sample was tested on a LM100TXS8 module. #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547988"></a>
                                                                               #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547989"></a>
          ################################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3547990"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3547991"></a>
          package require Ixia</p>
        <p class="CodeBlock"><a name="0_pgfId-3547992"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3547993"></a>
          set test_name [info script]</p>
        <p class="CodeBlock"><a name="0_pgfId-3547994"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3547995"></a>
          set chassisIP sylvester</p>
        <p class="CodeBlock"><a name="0_pgfId-3547996"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3547997"></a>
          ########</p>
        <p class="CodeBlock"><a name="0_pgfId-3547998"></a>
          # IpV4 #</p>
        <p class="CodeBlock"><a name="0_pgfId-3547999"></a>
          ########</p>
        <p class="CodeBlock"><a name="0_pgfId-3548000"></a>
          set ipV4_port_list "2/3 2/4"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548001"></a>
          set ipV4_ixia_list "1.1.1.2 1.1.1.1"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548002"></a>
          set ipV4_gateway_list "1.1.1.1 1.1.1.2"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548003"></a>
          set ipV4_netmask_list "255.255.255.0 255.255.255.0"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548004"></a>
          set ipV4_mac_list "0000.debb.0001 0000.debb.0002"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548005"></a>
          set ipV4_version_list "4 	 4"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548006"></a>
          set ipV4_autoneg_list "1 	 1"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548007"></a>
          set ipV4_duplex_list "full 	 full"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548008"></a>
          set ipV4_speed_list "ether100 ether100"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548009"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548010"></a>
          #################################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548011"></a>
                                 START TEST #</p>
        <p class="CodeBlock"><a name="0_pgfId-3548012"></a>
          #################################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548013"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548014"></a>
          # Connect to the chassis,reset to factory defaults and take ownership</p>
        <p class="CodeBlock"><a name="0_pgfId-3548015"></a>
          set connect_status [ixia::connect \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548016"></a>
                  -reset \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548017"></a>
                  -device $chassisIP \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548018"></a>
                  -port_list $ipV4_port_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548019"></a>
                  -username ixiaApiUser ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548020"></a>
          if {[keylget connect_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548021"></a>
              return "FAIL - $test_name - [keylget connect_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548022"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548023"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548024"></a>
          set port_one [keylget connect_status \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548025"></a>
                  port_handle.$chassisIP.[lindex $ipV4_port_list 0]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548026"></a>
          set port_two [keylget connect_status \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548027"></a>
                  port_handle.$chassisIP.[lindex $ipV4_port_list 1]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548028"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548029"></a>
          set port_handle [list $port_one $port_two]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548030"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548031"></a>
          ########################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548032"></a>
          # Configure interface in the test #</p>
        <p class="CodeBlock"><a name="0_pgfId-3548033"></a>
          # IPv4 #</p>
        <p class="CodeBlock"><a name="0_pgfId-3548034"></a>
          ########################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548035"></a>
          set interface_status [ixia::interface_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548036"></a>
                  -port_handle $port_handle \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548037"></a>
                  -intf_ip_addr $ipV4_ixia_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548038"></a>
                  -gateway $ipV4_gateway_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548039"></a>
                  -netmask $ipV4_netmask_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548040"></a>
                  -autonegotiation $ipV4_autoneg_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548041"></a>
                  -duplex $ipV4_duplex_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548042"></a>
                  -src_mac_addr $ipV4_mac_list \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548043"></a>
                  -speed $ipV4_speed_list ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548044"></a>
          if {[keylget interface_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548045"></a>
              return "FAIL - $test_name - [keylget interface_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548046"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548047"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548048"></a>
          ########################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548049"></a>
          # Stream configuration #</p>
        <p class="CodeBlock"><a name="0_pgfId-3548050"></a>
          # IPv4 #</p>
        <p class="CodeBlock"><a name="0_pgfId-3548051"></a>
          ########################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548052"></a>
          # Delete all the streams first</p>
        <p class="CodeBlock"><a name="0_pgfId-3548053"></a>
          set traffic_status [ixia::traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548054"></a>
                  -mode reset \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548055"></a>
                  -port_handle $port_handle ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548056"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548057"></a>
          set stream_index_list ""</p>
        <p class="CodeBlock"><a name="0_pgfId-3548058"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548059"></a>
          # Configure first stream on the IpV4 port</p>
        <p class="CodeBlock"><a name="0_pgfId-3548060"></a>
          set traffic_status [ixia::traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548061"></a>
                  -mode create \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548062"></a>
                  -port_handle $port_one \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548063"></a>
                  -l3_protocol ipv4 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548064"></a>
                  -ip_src_addr [lindex $ipV4_ixia_list 0] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548065"></a>
                  -ip_dst_addr [lindex $ipV4_ixia_list 1] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548066"></a>
                  -l3_length 46 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548067"></a>
                  -rate_percent 50 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548068"></a>
                  -mac_dst_mode discovery \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548069"></a>
                  -mac_src [lindex $ipV4_mac_list 0] ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548070"></a>
          if {[keylget traffic_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548071"></a>
              return "FAIL - $test_name - [keylget traffic_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548072"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548073"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548074"></a>
          lappend stream_index_list [keylget traffic_status stream_id]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548075"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548076"></a>
          # Configure second stream on the IpV4 port</p>
        <p class="CodeBlock"><a name="0_pgfId-3548077"></a>
          set traffic_status [ixia::traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548078"></a>
                  -mode create \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548079"></a>
                  -port_handle $port_one \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548080"></a>
                  -l3_protocol ipv4 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548081"></a>
                  -ip_src_addr [lindex $ipV4_ixia_list 0] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548082"></a>
                  -ip_dst_addr [lindex $ipV4_ixia_list 1] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548083"></a>
                  -l3_length 54 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548084"></a>
                  -rate_percent 50 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548085"></a>
                  -mac_dst_mode discovery \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548086"></a>
                  -mac_src [lindex $ipV4_mac_list 0] ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548087"></a>
          if {[keylget traffic_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548088"></a>
              return "FAIL - $test_name - [keylget traffic_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548089"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548090"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548091"></a>
          lappend stream_index_list [keylget traffic_status stream_id]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548092"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548093"></a>
          # Configure third stream on the IpV4 port</p>
        <p class="CodeBlock"><a name="0_pgfId-3548094"></a>
          set traffic_status [ixia::traffic_config \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548095"></a>
                  -mode create \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548096"></a>
                  -port_handle $port_one \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548097"></a>
                  -l3_protocol ipv4 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548098"></a>
                  -ip_src_addr [lindex $ipV4_ixia_list 0] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548099"></a>
                  -ip_dst_addr [lindex $ipV4_ixia_list 1] \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548100"></a>
                  -l3_length 65 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548101"></a>
                  -rate_percent 50 \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548102"></a>
                  -mac_dst_mode discovery \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548103"></a>
                  -mac_src [lindex $ipV4_mac_list 0] ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548104"></a>
          if {[keylget traffic_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548105"></a>
              return "FAIL - $test_name - [keylget traffic_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548106"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548107"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548108"></a>
          lappend stream_index_list [keylget traffic_status stream_id]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548109"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548110"></a>
          ########################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548111"></a>
          # Traffic control #</p>
        <p class="CodeBlock"><a name="0_pgfId-3548112"></a>
          ########################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548113"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548114"></a>
          # Clear stats before sending traffic</p>
        <p class="CodeBlock"><a name="0_pgfId-3548115"></a>
          set clear_stats_status [ixia::traffic_control \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548116"></a>
                  -port_handle $port_handle \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548117"></a>
                  -action clear_stats ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548118"></a>
          if {[keylget clear_stats_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548119"></a>
              return "FAIL - $test_name - [keylget clear_stats_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548120"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548121"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548122"></a>
          # Start the traffic on TX port</p>
        <p class="CodeBlock"><a name="0_pgfId-3548123"></a>
          set traffic_start_status [ixia::traffic_control	\</p>
        <p class="CodeBlock"><a name="0_pgfId-3548124"></a>
                  -port_handle $port_one \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548125"></a>
                  -action run ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548126"></a>
          if {[keylget traffic_start_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548127"></a>
              return "FAIL - $test_name - [keylget traffic_start_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548128"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548129"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548130"></a>
          # Sleep 5 seconds</p>
        <p class="CodeBlock"><a name="0_pgfId-3548131"></a>
          ixia_sleep 5000</p>
        <p class="CodeBlock"><a name="0_pgfId-3548132"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548133"></a>
          ###############################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548134"></a>
          # Retrieve stats while running</p>
        <p class="CodeBlock"><a name="0_pgfId-3548135"></a>
          ###############################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548136"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548137"></a>
          # Get aggregrate stats for all ports</p>
        <p class="CodeBlock"><a name="0_pgfId-3548138"></a>
          set aggregate_stats [ixia::traffic_stats -port_handle $port_handle]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548139"></a>
          if {[keylget aggregate_stats status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548140"></a>
              return "FAIL - $test_name - [keylget aggregate_stats log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548141"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548142"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548143"></a>
          # Get rateStats on the RX port - per stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548144"></a>
          set rx_stream_stats [ixia::traffic_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548145"></a>
                  -port_handle $port_two \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548146"></a>
                  -mode streams \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548147"></a>
                  -stream [lindex $stream_index_list 0]]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548148"></a>
          if {[keylget rx_stream_stats status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548149"></a>
              return "FAIL - $test_name - [keylget rx_stream_stats log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548150"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548151"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548152"></a>
          proc post_stats {port_handle label key_list stat_key {stream ""}} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548153"></a>
              puts -nonewline [format "%-16s" $label]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548154"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548155"></a>
              foreach port $port_handle {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548156"></a>
                  if {$stream != ""} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548157"></a>
                      set key $port.stream.$stream.$stat_key</p>
        <p class="CodeBlock"><a name="0_pgfId-3548158"></a>
                  } else {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548159"></a>
                      set key $port.$stat_key</p>
        <p class="CodeBlock"><a name="0_pgfId-3548160"></a>
                  }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548161"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548162"></a>
                  puts -nonewline "[format "%-16s" [keylget key_list $key]]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548163"></a>
              }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548164"></a>
              puts ""</p>
        <p class="CodeBlock"><a name="0_pgfId-3548165"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548166"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548167"></a>
          puts "\n******************* RUNNING COUNT STATS **********************"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548168"></a>
          puts "\t\t$port_one\t\t$port_two"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548169"></a>
          puts "\t\t-----\t\t-----"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548170"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548171"></a>
          post_stats $port_handle "Elapsed Time" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548172"></a>
                  aggregate.tx.elapsed_time</p>
        <p class="CodeBlock"><a name="0_pgfId-3548173"></a>
          post_stats $port_handle "Packets Tx" $aggregate_stats aggregate.tx.pkt_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548174"></a>
          post_stats $port_handle "Bytes Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548175"></a>
                  aggregate.tx.pkt_byte_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548176"></a>
          post_stats $port_handle "Bits Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548177"></a>
                  aggregate.tx.pkt_bit_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548178"></a>
          post_stats $port_handle "Packets Rx" $aggregate_stats aggregate.rx.pkt_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548179"></a>
          post_stats $port_handle "Collisions" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548180"></a>
                  aggregate.rx.collisions_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548181"></a>
          post_stats $port_handle "Dribble Errors" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548182"></a>
                  aggregate.rx.dribble_errors_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548183"></a>
          post_stats $port_handle "CRCs" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548184"></a>
                  aggregate.rx.crc_errors_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548185"></a>
          post_stats $port_handle "Oversizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548186"></a>
                  aggregate.rx.oversize_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548187"></a>
          post_stats $port_handle "Undersizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548188"></a>
                  aggregate.rx.undersize_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548189"></a>
          post_stats $port_handle "RX PCKTS TOS0" $aggregate_stats aggregate.rx.qos0_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548190"></a>
          post_stats $port_handle "RX PCKTS TOS1" $aggregate_stats aggregate.rx.qos1_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548191"></a>
          post_stats $port_handle "RX PCKTS TOS2" $aggregate_stats aggregate.rx.qos2_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548192"></a>
          post_stats $port_handle "RX PCKTS TOS3" $aggregate_stats aggregate.rx.qos3_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548193"></a>
          post_stats $port_handle "RX PCKTS TOS4" $aggregate_stats aggregate.rx.qos4_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548194"></a>
          post_stats $port_handle "RX PCKTS TOS5" $aggregate_stats aggregate.rx.qos5_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548195"></a>
          post_stats $port_handle "RX PCKTS TOS6" $aggregate_stats aggregate.rx.qos6_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548196"></a>
          post_stats $port_handle "RX PCKTS TOS7" $aggregate_stats aggregate.rx.qos7_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548197"></a>
          puts "******************************************************\n"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548198"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548199"></a>
          puts "\n******************* RUNNING RATE STATS ***********************"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548200"></a>
          puts "\t\t$port_one\t\t$port_two"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548201"></a>
          puts "\t\t-----\t\t-----"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548202"></a>
          post_stats $port_handle "Packets Tx" $aggregate_stats aggregate.tx.pkt_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548203"></a>
          post_stats $port_handle "Bytes Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548204"></a>
                  aggregate.tx.pkt_byte_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548205"></a>
          post_stats $port_handle "Bits Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548206"></a>
                  aggregate.tx.pkt_bit_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548207"></a>
          post_stats $port_handle "Packets Rx" $aggregate_stats aggregate.rx.pkt_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548208"></a>
          post_stats $port_handle "Collisions" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548209"></a>
                  aggregate.rx.collisions_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548210"></a>
          post_stats $port_handle "Dribble Errors" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548211"></a>
                  aggregate.rx.dribble_errors_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548212"></a>
          post_stats $port_handle "CRCs" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548213"></a>
                  aggregate.rx.crc_errors_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548214"></a>
          post_stats $port_handle "Oversizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548215"></a>
                  aggregate.rx.oversize_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548216"></a>
          post_stats $port_handle "Undersizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548217"></a>
                  aggregate.rx.undersize_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548218"></a>
          post_stats $port_handle "RX PCKTS TOS0" $aggregate_stats aggregate.rx.qos0_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548219"></a>
          post_stats $port_handle "RX PCKTS TOS1" $aggregate_stats aggregate.rx.qos1_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548220"></a>
          post_stats $port_handle "RX PCKTS TOS2" $aggregate_stats aggregate.rx.qos2_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548221"></a>
          post_stats $port_handle "RX PCKTS TOS3" $aggregate_stats aggregate.rx.qos3_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548222"></a>
          post_stats $port_handle "RX PCKTS TOS4" $aggregate_stats aggregate.rx.qos4_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548223"></a>
          post_stats $port_handle "RX PCKTS TOS5" $aggregate_stats aggregate.rx.qos5_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548224"></a>
          post_stats $port_handle "RX PCKTS TOS6" $aggregate_stats aggregate.rx.qos6_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548225"></a>
          post_stats $port_handle "RX PCKTS TOS7" $aggregate_stats aggregate.rx.qos7_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548226"></a>
          puts "******************************************************"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548227"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548228"></a>
          ixia_sleep 8000</p>
        <p class="CodeBlock"><a name="0_pgfId-3548229"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548230"></a>
          # Stop traffic on the TX port</p>
        <p class="CodeBlock"><a name="0_pgfId-3548231"></a>
          set traffic_stop_status [ixia::traffic_control \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548232"></a>
          	-port_handle $port_one \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548233"></a>
                  -action stop ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548234"></a>
          if {[keylget traffic_stop_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548235"></a>
              return "FAIL - $test_name - [keylget traffic_stop_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548236"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548237"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548238"></a>
          ###############################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548239"></a>
          # Retrieve stats after stopped</p>
        <p class="CodeBlock"><a name="0_pgfId-3548240"></a>
          ###############################################################################</p>
        <p class="CodeBlock"><a name="0_pgfId-3548241"></a>
          # Get aggregrate stats for all ports</p>
        <p class="CodeBlock"><a name="0_pgfId-3548242"></a>
          set aggregate_stats [ixia::traffic_stats -port_handle $port_handle]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548243"></a>
          if {[keylget aggregate_stats status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548244"></a>
              return "FAIL - $test_name - [keylget aggregate_stats log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548245"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548246"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548247"></a>
          puts "\n\t\t########################"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548248"></a>
          puts "\t\t# STATIC STATS #"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548249"></a>
          puts "\t\t########################"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548250"></a>
          puts "\n******************* FINAL COUNT STATS **********************"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548251"></a>
          puts "\t\t$port_one\t\t$port_two"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548252"></a>
          puts "\t\t-----\t\t-----"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548253"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548254"></a>
          post_stats $port_handle "Elapsed Time" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548255"></a>
                  aggregate.tx.elapsed_time</p>
        <p class="CodeBlock"><a name="0_pgfId-3548256"></a>
          post_stats $port_handle "Packets Tx" $aggregate_stats aggregate.tx.pkt_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548257"></a>
          post_stats $port_handle "Bytes Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548258"></a>
                  aggregate.tx.pkt_byte_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548259"></a>
          post_stats $port_handle "Bits Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548260"></a>
                  aggregate.tx.pkt_bit_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548261"></a>
          post_stats $port_handle "Packets Rx" $aggregate_stats aggregate.rx.pkt_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548262"></a>
          post_stats $port_handle "Collisions" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548263"></a>
                  aggregate.rx.collisions_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548264"></a>
          post_stats $port_handle "Dribble Errors" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548265"></a>
                  aggregate.rx.dribble_errors_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548266"></a>
          post_stats $port_handle "CRCs" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548267"></a>
                  aggregate.rx.crc_errors_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548268"></a>
          post_stats $port_handle "Oversizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548269"></a>
                  aggregate.rx.oversize_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548270"></a>
          post_stats $port_handle "Undersizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548271"></a>
                  aggregate.rx.undersize_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548272"></a>
          post_stats $port_handle "RX PCKTS TOS0" $aggregate_stats aggregate.rx.qos0_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548273"></a>
          post_stats $port_handle "RX PCKTS TOS1" $aggregate_stats aggregate.rx.qos1_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548274"></a>
          post_stats $port_handle "RX PCKTS TOS2" $aggregate_stats aggregate.rx.qos2_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548275"></a>
          post_stats $port_handle "RX PCKTS TOS3" $aggregate_stats aggregate.rx.qos3_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548276"></a>
          post_stats $port_handle "RX PCKTS TOS4" $aggregate_stats aggregate.rx.qos4_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548277"></a>
          post_stats $port_handle "RX PCKTS TOS5" $aggregate_stats aggregate.rx.qos5_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548278"></a>
          post_stats $port_handle "RX PCKTS TOS6" $aggregate_stats aggregate.rx.qos6_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548279"></a>
          post_stats $port_handle "RX PCKTS TOS7" $aggregate_stats aggregate.rx.qos7_count</p>
        <p class="CodeBlock"><a name="0_pgfId-3548280"></a>
          puts "******************************************************\n"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548281"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548282"></a>
          puts "\n******************* FINAL RATE STATS ***********************"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548283"></a>
          puts "\t\t$port_one\t\t$port_two"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548284"></a>
          puts "\t\t-----\t\t-----"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548285"></a>
          post_stats $port_handle "Packets Tx" $aggregate_stats aggregate.tx.pkt_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548286"></a>
          post_stats $port_handle "Bytes Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548287"></a>
                  aggregate.tx.pkt_byte_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548288"></a>
          post_stats $port_handle "Bits Tx" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548289"></a>
                  aggregate.tx.pkt_bit_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548290"></a>
          post_stats $port_handle "Packets Rx" $aggregate_stats aggregate.rx.pkt_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548291"></a>
          post_stats $port_handle "Collisions" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548292"></a>
                  aggregate.rx.collisions_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548293"></a>
          post_stats $port_handle "Dribble Errors" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548294"></a>
                  aggregate.rx.dribble_errors_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548295"></a>
          post_stats $port_handle "CRCs" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548296"></a>
                  aggregate.rx.crc_errors_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548297"></a>
          post_stats $port_handle "Oversizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548298"></a>
                  aggregate.rx.oversize_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548299"></a>
          post_stats $port_handle "Undersizes" $aggregate_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548300"></a>
                  aggregate.rx.undersize_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548301"></a>
          post_stats $port_handle "RX PCKTS TOS0" $aggregate_stats aggregate.rx.qos0_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548302"></a>
          post_stats $port_handle "RX PCKTS TOS1" $aggregate_stats aggregate.rx.qos1_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548303"></a>
          post_stats $port_handle "RX PCKTS TOS2" $aggregate_stats aggregate.rx.qos2_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548304"></a>
          post_stats $port_handle "RX PCKTS TOS3" $aggregate_stats aggregate.rx.qos3_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548305"></a>
          post_stats $port_handle "RX PCKTS TOS4" $aggregate_stats aggregate.rx.qos4_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548306"></a>
          post_stats $port_handle "RX PCKTS TOS5" $aggregate_stats aggregate.rx.qos5_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548307"></a>
          post_stats $port_handle "RX PCKTS TOS6" $aggregate_stats aggregate.rx.qos6_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548308"></a>
          post_stats $port_handle "RX PCKTS TOS7" $aggregate_stats aggregate.rx.qos7_rate</p>
        <p class="CodeBlock"><a name="0_pgfId-3548309"></a>
          puts "******************************************************"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548310"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548311"></a>
          foreach stream $stream_index_list {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548312"></a>
              # Get Stats on the RX port - per stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548313"></a>
              set rx_stream_stats [ixia::traffic_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548314"></a>
                      -port_handle $port_two \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548315"></a>
                      -mode streams \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548316"></a>
                      -stream $stream ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548317"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548318"></a>
              puts "\n********** PER-STREAM RATE STATS - STREAM $stream**********"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548319"></a>
              puts "\t\t$port_two"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548320"></a>
              puts "\t\t-----"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548321"></a>
              post_stats $port_two "Packets Rx" $rx_stream_stats rx.total_pkts \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548322"></a>
                      $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548323"></a>
              post_stats $port_two "Bytes Rx" $rx_stream_stats rx.total_pkt_bytes \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548324"></a>
                      $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548325"></a>
              post_stats $port_two "Bits Rate" $rx_stream_stats rx.total_pkt_bit_rate \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548326"></a>
                      $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548327"></a>
              post_stats $port_two "Line Rate" $rx_stream_stats \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548328"></a>
                      rx.line_rate_percentage $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548329"></a>
              post_stats $port_two "Average Delay" $rx_stream_stats rx.avg_delay \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548330"></a>
                      $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548331"></a>
              post_stats $port_two "Min. Delay" $rx_stream_stats rx.min_delay \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548332"></a>
                      $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548333"></a>
              post_stats $port_two "Max. Delay" $rx_stream_stats rx.max_delay \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548334"></a>
                      $stream</p>
        <p class="CodeBlock"><a name="0_pgfId-3548335"></a>
              puts "******************************************************\n"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548336"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548337"></a>
          # Clean up the connection</p>
        <p class="CodeBlock"><a name="0_pgfId-3548338"></a>
          set cleanup_status [ixia::cleanup_session \</p>
        <p class="CodeBlock"><a name="0_pgfId-3548339"></a>
                  -port_handle $port_handle ]</p>
        <p class="CodeBlock"><a name="0_pgfId-3548340"></a>
          if {[keylget cleanup_status status] != $SUCCESS} {</p>
        <p class="CodeBlock"><a name="0_pgfId-3548341"></a>
              return "FAIL - $test_name - [keylget cleanup_status log]"</p>
        <p class="CodeBlock"><a name="0_pgfId-3548342"></a>
          }</p>
        <p class="CodeBlock"><a name="0_pgfId-3548343"></a>
          &#160;</p>
        <p class="CodeBlock"><a name="0_pgfId-3548344"></a>
          return "SUCCESS - $test_name - [clock format [clock seconds]]"          &#160;</p>
    </body>
</html>